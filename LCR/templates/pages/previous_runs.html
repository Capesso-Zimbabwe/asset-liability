{# templates/pages/previous_runs.html #}
{% extends "base/base.html" %}
{% load tailwind_tags %}

{% block content %}
  <h1 class="text-base font-semibold mb-4">Previous LCR Runs</h1>

  <div class="overflow-x-auto">
    <table class="w-full text-[13px] border border-gray-300 border-collapse bg-white">
      <thead>
        <tr class="bg-[#171426] text-white">
          <th class="px-3 py-2 border border-gray-300 text-left">Run Name</th>
          <th class="px-3 py-2 border border-gray-300 text-left">Reporting Date</th>
          <th class="px-3 py-2 border border-gray-300 text-left">Created At</th>
          <th class="px-3 py-2 border border-gray-300 text-left">Status</th>
          <th class="px-3 py-2 border border-gray-300 text-left">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for run in runs %}
          {% with s=run.status|default:"" %}
          <tr class="hover:bg-gray-50">
            <td class="px-3 py-2 border border-gray-300 font-medium">{{ run.run_name }}</td>
            <td class="px-3 py-2 border border-gray-300">{{ run.reporting_date|date:"F j, Y" }}</td>
            <td class="px-3 py-2 border border-gray-300">{{ run.created_at|date:"Y-m-d H:i" }}</td>
            <td class="px-3 py-2 border border-gray-300">
              {% if s|lower == "success" %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800">
                  Success
                </span>
              {% elif s|lower == "failed" or s|lower == "failure" %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800">
                  Failed
                </span>
              {% elif s|lower == "running" or s|lower == "in progress" %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
                  Running
                </span>
              {% elif s %}
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
                  {{ run.status }}
                </span>
              {% else %}
                <span class="text-xs text-gray-500">â€”</span>
              {% endif %}
            </td>
            <td class="px-3 py-2 border border-gray-300">
              <a href="{% url 'LCR:lcr_run' %}?reporting_date={{ run.reporting_date|date:'Y-m-d' }}"
                 class="text-indigo-600 hover:underline">
                View Details
              </a>
            </td>
          </tr>
          {% endwith %}
        {% empty %}
          <tr>
            <td colspan="5" class="px-3 py-4 border border-gray-300 text-center text-gray-500">
              No previous runs found.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
